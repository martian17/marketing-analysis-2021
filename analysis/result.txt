> # teamD
> ifile="つりだし.xlsx"
> # ライフスタイル・データの読み込み
> lsce <- read.xlsx( ifile, sheet=1, colNames=TRUE, rowNames=TRUE)
 read.xlsx.default(ifile, sheet = 1, colNames = TRUE, rowNames = TRUE) でエラー: 
  File does not exist.
> setwd("~/Google ドライブ/2. course/c20/mktgSt2020s/マーケティング戦略/前夜祭６月29日/つりだし")
> # ライフスタイル・データの読み込み
> lsce <- read.xlsx( ifile, sheet=1, colNames=TRUE, rowNames=TRUE)
> colnames(lsce)
 [1] "X2"  "X3"  "X4"  "X5"  "X6"  "X7"  "X8"  "X9"  "X10" "X11" "X12" "X13" "X14" "X15" "X16" "X17" "X18" "X19"
[19] "X20" "X21" "X22" "X23" "X24" "X25" "X26" "X27" "X28" "X29" "X30" "X31" "X32" "X33" "X34" "X35" "X36" "X37"
[37] "X38" "X39" "X40" "X41" "X42" "X43" "X44"
> # ライフスタイル・データの読み込み
> lsce <- read.xlsx( ifile, sheet=1, colNames=TRUE, rowNames=TRUE)
> colnames(lsce)
 [1] "v1"  "v2"  "v3"  "v4"  "v5"  "v6"  "v7"  "v8"  "v9"  "v10" "v11" "v12" "v13" "v14" "v15" "v16" "v17" "v18"
[19] "v19" "v20" "v21" "v22" "v23" "v24" "v25" "v26" "v27" "v28" "v29" "v30" "v31" "v32" "v33" "v34" "v35" "v36"
[37] "v37"
> # 因子分析用データ作成
> lscef <- lsce
> head(lscef)
  v1 v2 v3 v4 v5 v6 v7 v8 v9 v10 v11 v12 v13 v14 v15 v16 v17 v18 v19 v20 v21 v22 v23 v24 v25 v26 v27 v28 v29 v30
1  5  5  4  2  2  4  4  5  5   3   3   1   3   1   1   1   1   3   3   5   1   3   3   1   1   1   1   1   1   1
2  2  1  3  2  2  4  3  4  4   4   2   4   4   3   4   3   3   5   3   5   3   4   4   2   3   3   2   4   4   1
3  4  3  4  1  3  5  4  4  5   5   5   3   4   4   2   3   3   5   2   5   4   3   5   1   5   2   1   2   2   1
4  4  4  4  4  2  4  4  4  5   4   4   5   4   3   4   4   4   5   4   5   4   3   3   4   5   4   1   3   5   4
5  3  3  4  3  2  5  5  4  4   3   3   4   4   4   3   3   3   4   5   4   2   2   2   1   3   5   3   1   1   4
6  5  5  5  5  5  5  3  3  3   3   3   3   5   5   1   3   1   5   5   5   5   5   5   1   1   1   1   1   1   1
  v31 v32 v33 v34 v35 v36 v37
1   4   1   1   3   2   3   5
2   2   2   2   3   3   3   5
3   1   1   1   1   1   3   5
4   2   5   4   1   1   3   5
5   2   1   4   3   2   3   3
6   3   3   5   3   5   5   5
> # determin # of factors
>    # Principa Componet Analysis（pca: all.Rが必要）
>       ans <- pca(lscef)
>       print(ans)

主成分分析の結果

                 PC1     PC2     PC3     PC4     PC5     PC6     PC7     PC8     PC9    PC10    PC11    PC12    PC13  Contribution
          v1   0.103  -0.531   0.164  -0.172  -0.022   0.327  -0.297   0.190   0.228   0.043   0.077   0.214  -0.313   0.784
          v2  -0.162  -0.516  -0.234   0.036  -0.092   0.020  -0.117   0.378   0.246   0.021   0.147  -0.124   0.053   0.616
          v3  -0.153  -0.543  -0.002  -0.040  -0.127   0.236  -0.038   0.427  -0.044   0.023   0.041  -0.026  -0.040   0.582
          v4  -0.310  -0.286   0.595  -0.006  -0.057  -0.288  -0.160  -0.123   0.071  -0.277   0.009   0.113  -0.129   0.771
          v5  -0.359  -0.172   0.428  -0.082  -0.116  -0.502  -0.069  -0.056   0.009  -0.355   0.040   0.183  -0.244   0.843
          v6  -0.331  -0.260   0.003   0.120  -0.416  -0.039   0.242   0.004  -0.166  -0.153  -0.225   0.158   0.177   0.583
          v7  -0.461   0.300  -0.341  -0.238   0.005  -0.094   0.066  -0.102  -0.007  -0.312   0.147   0.131  -0.082   0.642
          v8  -0.310  -0.076  -0.429   0.108   0.418  -0.162   0.091   0.060  -0.228  -0.097  -0.059   0.190   0.106   0.622
          v9  -0.512   0.348  -0.246   0.017   0.251  -0.023   0.044   0.010   0.085   0.121   0.101  -0.078  -0.286   0.630
         v10  -0.477   0.314  -0.218  -0.131   0.197  -0.001   0.046   0.049   0.046  -0.220   0.370   0.036  -0.236   0.679
         v11  -0.340  -0.101  -0.275   0.058   0.045   0.522   0.142   0.039  -0.215  -0.349   0.042  -0.073  -0.246   0.736
         v12  -0.493   0.133   0.288   0.256  -0.030   0.087   0.207  -0.011  -0.371   0.164   0.174  -0.150  -0.179   0.710
         v13  -0.417   0.240   0.334   0.155  -0.240   0.408   0.258   0.117  -0.022   0.014   0.163   0.227  -0.011   0.750
         v14  -0.702  -0.287  -0.188   0.232  -0.000  -0.091   0.050  -0.095   0.209   0.057   0.025  -0.050   0.168   0.763
         v15  -0.568  -0.474  -0.102   0.399   0.175   0.003  -0.019  -0.066  -0.101   0.197  -0.039  -0.067  -0.059   0.811
         v16  -0.673  -0.327  -0.174   0.293   0.050  -0.056   0.007  -0.154   0.242  -0.005  -0.007  -0.019   0.132   0.782
         v17  -0.640  -0.345  -0.017   0.372   0.194  -0.024  -0.091  -0.025  -0.058   0.074   0.158   0.169   0.075   0.781
         v18  -0.420   0.191  -0.081  -0.356  -0.043  -0.056  -0.085  -0.068   0.147   0.368  -0.161   0.096  -0.099   0.565
         v19  -0.344  -0.101  -0.081  -0.449  -0.216   0.136  -0.192  -0.279  -0.387   0.196   0.008   0.181   0.129   0.753
         v20  -0.345  -0.250  -0.312  -0.513  -0.301  -0.035  -0.069   0.009  -0.174   0.130  -0.034   0.164  -0.046   0.716
         v21  -0.536   0.241  -0.202  -0.302  -0.072   0.154   0.083   0.003   0.067   0.093  -0.304   0.254  -0.057   0.687
         v22  -0.564   0.227   0.094  -0.298  -0.068   0.005  -0.051   0.004   0.206  -0.142  -0.120  -0.291  -0.103   0.647
         v23  -0.403   0.010  -0.097   0.014  -0.287   0.177   0.228   0.129   0.224  -0.311  -0.461  -0.250   0.062   0.780
         v24  -0.442  -0.096   0.105   0.209   0.029  -0.160  -0.113  -0.178  -0.065   0.055  -0.420  -0.024  -0.245   0.574
         v25  -0.243   0.313   0.242   0.348  -0.080   0.035  -0.142   0.180  -0.006   0.376  -0.217  -0.014  -0.277   0.662
         v26  -0.347   0.413   0.382   0.193   0.010   0.330  -0.260  -0.032   0.082   0.010   0.034   0.170   0.137   0.708
         v27  -0.183   0.001  -0.019  -0.214   0.082   0.062  -0.630   0.296  -0.181  -0.130   0.038  -0.256   0.013   0.692
         v28  -0.429   0.296   0.056   0.013  -0.038   0.042  -0.429   0.075   0.222  -0.104   0.013   0.161   0.378   0.697
         v29  -0.490   0.455  -0.105   0.150   0.067  -0.039  -0.217  -0.011   0.095   0.049   0.115  -0.048   0.178   0.592
         v30  -0.307  -0.086   0.048  -0.098  -0.050  -0.137  -0.243   0.013  -0.531  -0.017  -0.048  -0.332   0.109   0.600
         v31   0.257  -0.358  -0.000  -0.183   0.523   0.173  -0.002  -0.122   0.057   0.003  -0.209   0.249  -0.039   0.656
         v32  -0.049  -0.284   0.074  -0.203   0.013   0.284   0.011  -0.478   0.278   0.068   0.077  -0.251   0.012   0.590
         v33  -0.251  -0.245   0.230  -0.241   0.013   0.186   0.042  -0.526   0.038   0.042   0.228  -0.237   0.037   0.660
         v34  -0.250  -0.116   0.386  -0.319   0.647   0.038   0.155   0.175  -0.056  -0.032  -0.115   0.054   0.155   0.846
         v35  -0.383   0.083   0.459  -0.316   0.363   0.112   0.276   0.224  -0.070  -0.003  -0.159  -0.154   0.193   0.826
         v36  -0.330  -0.109   0.245  -0.176  -0.251  -0.106   0.337   0.201  -0.007   0.141   0.334   0.083   0.178   0.610
         v37  -0.274  -0.066  -0.022  -0.353   0.017  -0.414   0.228   0.260   0.213   0.302   0.104  -0.144  -0.062   0.668
  Eigenvalue   6.037   3.060   2.254   2.211   1.763   1.575   1.516   1.417   1.326   1.205   1.189   1.059   1.002
Contribution   0.163   0.083   0.061   0.060   0.048   0.043   0.041   0.038   0.036   0.033   0.032   0.029   0.027
Cum.contrib.   0.163   0.246   0.307   0.367   0.414   0.457   0.498   0.536   0.572   0.604   0.637   0.665   0.692
> 
>    # 関数screeplotが使えないので、plotを使う
>       plot(ans$eval, type="b", xlab="PCS", ylab="Variance", main="Scree Plot")
> # 因子分析 psych::fa
> # fa()による、主因子法 →　バリマックス回転
> fa.pavm <- fa(lscef, fm="pa", nfactors=4, rotate="varimax")
> print(fa.pavm, digits=3)
Factor Analysis using method =  pa
Call: fa(r = lscef, nfactors = 4, rotate = "varimax", fm = "pa")
Standardized loadings (pattern matrix) based upon correlation matrix
       PA1    PA3    PA2    PA4     h2    u2  com
v1   0.066 -0.112 -0.416  0.251 0.2526 0.747 1.88
v2   0.375  0.053 -0.311  0.028 0.2405 0.759 1.99
v3   0.289  0.011 -0.314  0.209 0.2261 0.774 2.74
v4   0.155 -0.099  0.035  0.639 0.4431 0.557 1.17
v5   0.144  0.064  0.064  0.485 0.2645 0.736 1.25
v6   0.312  0.087 -0.019  0.163 0.1321 0.868 1.70
v7   0.105  0.568  0.232 -0.093 0.3959 0.604 1.46
v8   0.346  0.212  0.035 -0.172 0.1953 0.805 2.22
v9   0.210  0.403  0.408 -0.091 0.3812 0.619 2.59
v10  0.134  0.447  0.315 -0.030 0.3178 0.682 2.02
v11  0.297  0.215  0.035 -0.035 0.1371 0.863 1.89
v12  0.251  0.043  0.427  0.281 0.3257 0.674 2.45
v13  0.096  0.082  0.432  0.283 0.2824 0.718 1.93
v14  0.742  0.250  0.120  0.121 0.6414 0.359 1.34
v15  0.828 -0.026  0.017  0.150 0.7095 0.290 1.07
v16  0.777  0.173  0.111  0.115 0.6594 0.341 1.19
v17  0.754  0.028  0.159  0.217 0.6418 0.358 1.26
v18  0.040  0.476  0.144  0.124 0.2640 0.736 1.34
v19  0.080  0.437 -0.115  0.199 0.2497 0.750 1.64
v20  0.166  0.589 -0.332  0.106 0.4957 0.504 1.84
v21  0.115  0.593  0.218  0.064 0.4166 0.583 1.38
v22  0.071  0.490  0.282  0.293 0.4106 0.589 2.36
v23  0.222  0.250  0.133  0.085 0.1367 0.863 2.79
v24  0.339  0.068  0.191  0.202 0.1969 0.803 2.39
v25  0.073 -0.075  0.456  0.089 0.2273 0.773 1.19
v26 -0.001  0.010  0.579  0.239 0.3924 0.608 1.33
v27  0.031  0.190  0.003  0.101 0.0473 0.953 1.58
v28  0.102  0.248  0.374  0.114 0.2245 0.775 2.13
v29  0.165  0.294  0.555 -0.062 0.4252 0.575 1.75
v30  0.154  0.173  0.035  0.181 0.0876 0.912 3.03
v31 -0.045 -0.120 -0.369  0.033 0.1539 0.846 1.26
v32  0.062  0.046 -0.199  0.163 0.0720 0.928 2.27
v33  0.111  0.129 -0.094  0.337 0.1512 0.849 1.71
v34 -0.001  0.121  0.002  0.440 0.2083 0.792 1.15
v35 -0.050  0.222  0.191  0.518 0.3562 0.644 1.68
v36  0.105  0.173  0.031  0.337 0.1552 0.845 1.74
v37  0.060  0.314 -0.061  0.168 0.1344 0.866 1.71

                        PA1   PA3   PA2   PA4
SS loadings           3.454 2.783 2.660 2.155
Proportion Var        0.093 0.075 0.072 0.058
Cumulative Var        0.093 0.169 0.240 0.299
Proportion Explained  0.313 0.252 0.241 0.195
Cumulative Proportion 0.313 0.564 0.805 1.000

Mean item complexity =  1.8
Test of the hypothesis that 4 factors are sufficient.

The degrees of freedom for the null model are  666  and the objective function was  14.582 with Chi Square of  1849.473
The degrees of freedom for the model are 524  and the objective function was  6.742 

The root mean square of the residuals (RMSR) is  0.067 
The df corrected root mean square of the residuals is  0.076 

The harmonic number of observations is  141 with the empirical chi square  844.669  with prob <  1.96e-17 
The total number of observations was  141  with Likelihood Chi Square =  837.186  with prob <  8.22e-17 

Tucker Lewis Index of factoring reliability =  0.6522
RMSEA index =  0.0647  and the 90 % confidence intervals are  0.057 0.0735
BIC =  -1755.964
Fit based upon off diagonal values = 0.858
Measures of factor score adequacy             
                                                    PA1   PA3   PA2   PA4
Correlation of (regression) scores with factors   0.936 0.889 0.883 0.858
Multiple R square of scores with factors          0.876 0.790 0.780 0.736
Minimum correlation of possible factor scores     0.752 0.579 0.561 0.473
> 
> 
> # 因子得点
> fs <- factor.scores(lscef, fa.pavm, Phi = NULL, method = c("Thurstone"),rho=NULL,impute="none")
> 
> fs$scores
             PA1          PA3         PA2          PA4
1   -1.115034232 -0.030077943 -2.02379332 -1.352806865
2    0.257454068 -0.085577372  0.49920337 -0.717855478
3    0.394230648  0.509173569 -0.08577489 -1.868443927
4    1.058933204  0.164116079  0.38341641 -0.097408422
5    0.431137293 -0.697847482 -0.21433292 -0.339285938
6   -0.731396113  0.865073361 -1.88353244  2.175687317
7    0.356621244  0.780113658  0.79052643  0.534920456
8    0.671452721  0.324798768 -0.75071753 -1.200291863
9    1.489299227  0.653218018 -0.45579189  0.667345415
10  -0.654728403  0.840321912  0.51425812 -0.668762336
11   0.861889382 -0.566880955  0.06961991  1.448484155
12  -0.223753427  0.579263207 -1.45178790 -0.621790565
13  -0.026486543  1.158879651 -0.20228543  0.367928723
14   0.159199726 -0.532805736  0.12953055  0.548410181
15   0.041628245  0.509774021  1.03066927  0.806852255
16   1.046552082 -0.047841226  0.15497654 -0.204346013
17   1.165633805  0.788761797  1.26285594  0.491974042
18  -0.444504863  1.010330104 -0.48413226 -0.104503746
19   0.095234287 -0.931185808 -0.08651792  0.495813184
20  -0.302150184  0.324287125  0.68290426  0.154443749
21  -0.321623100  0.215239919  0.51344389  0.916547811
22  -0.556855327  1.088021087 -0.26383380 -0.143634521
23  -0.713179425 -0.654736769  0.08643453  0.813626564
24  -0.321218149 -0.429147064  0.09127802  0.787102195
25   1.103786905  0.437445764  0.43629132  0.651700538
26  -0.305945345  1.388836814  0.60617069 -0.016723860
27   0.468179691  0.916486790  1.54243896  0.977395972
28  -1.074825814  0.695364990  0.35506781  1.665312794
29  -0.091122957  0.418971586  0.94087218 -0.303193573
30  -1.421918270 -0.531768577  0.41326573  0.363865987
31  -0.536516012  0.209122320  0.26886794  0.278969525
32  -1.890985753  0.919037849  0.79601666 -0.416592741
33  -0.743001868  0.519273126 -0.74551678  0.102157982
34   0.205407799  0.853023329  0.82145526  0.368213593
35  -0.005927833  0.366871454 -1.10213777 -0.398972615
36   0.353469533  0.578343888  0.64122611 -0.280778323
37   0.700808163 -0.262095173  0.45916807  0.627927097
38   0.619612877  0.464070539 -1.29174634 -0.629515121
39  -0.061063148 -0.993416198 -1.50895536  1.181216342
40  -0.061063148 -0.993416198 -1.50895536  1.181216342
41  -0.793854146  0.487774435  0.70544333 -0.894446759
42   0.713536564  1.282461303  1.13618720  0.393430529
43  -0.974672610 -0.738618168  0.37283262 -0.758269452
44  -0.805789794  0.330219262  0.64640718 -0.627289530
45   0.976408267  0.941357745  0.67691325  0.585188348
46  -0.741834083 -0.734705712  2.44576941  0.634597002
47   0.740974745 -0.196883435 -1.14372941  0.007991683
48  -0.172746712 -0.655009469  0.33009823  1.044333696
49  -0.107805215 -2.733777292 -0.54083264 -0.912322975
50  -1.135508928 -0.225098259  1.07661384  0.847813987
51  -0.119273078  0.403312431 -0.08539076  0.359428973
52  -0.233848220  0.508208586 -0.46472530  0.410871388
53   1.515476242 -0.099331832 -0.37714618  1.511523310
54  -0.310967263 -0.069271706 -0.58059789  0.533152604
55  -1.513075812  0.189005797 -1.43757809 -0.425029482
56   0.419513630 -0.078742309  0.32848858  0.921480956
57   1.258117307 -0.772006750 -0.10151983 -0.867268876
58  -0.083740919  1.280192119 -0.39832354 -0.322536256
59   1.264329576  0.326547909  0.91496845  0.934651331
60  -1.000888862  0.937635683  0.12193505  0.870615060
61   0.481973685  0.136673477 -0.29611252  0.475074117
62   0.071412586  0.491516578 -0.27503966 -0.409130221
63   2.046822279 -0.942480714  0.17369218 -0.378744913
64   0.209075069  0.017685769  0.14396263 -0.816610390
65   1.495437715  0.281373920  0.68235233 -0.606457999
66   0.240533597  0.515046193  0.66988253 -0.326967493
67   1.147949019  0.742330964  0.28732341  0.520271726
68   0.245216235  0.178420664 -0.18120062 -0.550884816
69  -0.546607293  0.374280445  2.19102611  0.553454937
70   0.334208743 -0.887177664  0.37855829  1.358659244
71   0.591503107  0.638296406  0.65515241 -0.315019513
72   0.232469543 -0.168614215 -0.53142086  0.420601504
73   0.564440223  0.036669104 -0.86614412  0.725787581
74  -0.985733656 -0.470054486 -0.65337135  1.228454422
75  -0.234780354  0.417643577 -0.20965248 -0.944035732
76   1.192303712  0.611646476 -0.77482242 -1.437018037
77  -0.960459256  0.049667118 -0.09728468  0.012986085
78  -0.848813206 -0.140811285  1.06309820 -1.436754455
79   1.295150699 -0.249136288  1.12949678  1.046237672
80   1.776385944 -0.210141556 -1.63935479 -0.016957426
81   1.209163960  0.964703948  0.17064539  0.358873745
82   0.443570345  0.078855945  0.32560265  0.419342885
83   1.254871324 -1.726042226  1.45767779 -0.770086328
84   0.356450757 -0.654388885 -0.57005082  0.655058193
85  -1.617410653 -0.023253096 -0.13543626 -1.083758377
86   0.305991149 -1.500190849 -0.17222356 -0.432474339
87   0.251390949  0.019372824  0.68014037  0.188166748
88  -1.306962119  1.288025929  0.42061102 -2.812397830
89   1.280757652  0.051242961 -0.52256425 -1.392238719
90   0.638144616 -2.471830287 -1.62912302 -0.808406574
91  -1.072416879  0.426448656 -1.65470456  0.819194951
92   0.229548515 -1.027204533  0.74792721  0.442299165
93  -1.573238298 -0.828806197 -0.52280811  1.591028647
94   0.928332981  0.511518705  0.12494985 -0.629044388
95   1.947112346 -0.296006860  0.51368548  0.226005909
96   0.216583157  0.651773884  0.29642714 -0.598542401
97   0.835254703  0.391271893 -0.93574090  1.162495200
98  -0.558578389 -1.288708546  0.92529489 -1.573094374
99   1.013272282  1.002169315  0.58322623 -1.744601549
100 -0.074419224  0.767088097 -0.84608890 -1.225886405
101 -1.835523799 -2.179629704  1.70574673 -0.697473055
102 -1.835523799 -2.179629704  1.70574673 -0.697473055
103  0.734063953 -2.160127997  0.09906323 -0.248496344
104 -1.097924445 -1.440506270 -0.52571811 -0.609516180
105 -1.653938462 -1.911244562 -1.27277426 -0.580199126
106 -0.284403047  0.616335704 -0.58084085 -0.415085403
107 -0.509502430 -0.482132264  1.83261655  0.800913024
108 -0.314916908  0.859858602  0.41986750 -0.225372304
109  1.470683218 -0.707797219 -0.03277118 -0.282381097
110  1.853120827 -1.156236323 -0.21772292  0.236567023
111 -1.890985753  0.919037849  0.79601666 -0.416592741
112 -1.349340199 -0.188296750 -1.08319062 -0.967836197
113  0.419304358  0.174142077 -0.43930776  0.162330127
114  1.144436714  1.066099480  0.73877541 -0.105696144
115 -1.708706419  0.979442710 -0.66431668  0.798215323
116  1.358418579  1.235825131  0.11770091  0.384752664
117 -0.891666566 -0.516015842 -0.17383872  0.494349214
118  0.883891442  0.244792203 -0.80630729 -1.000515639
119  1.949405863 -1.062500809 -1.52868144  0.377343054
120 -0.304570976  0.088198403  0.82439580 -0.025783996
121 -0.811389211 -0.007775112 -0.18719430 -0.413524535
122 -0.493120142 -0.700997857 -0.05690176  1.276987224
123 -0.107805215 -2.733777292 -0.54083264 -0.912322975
124 -2.137710728 -0.022147441 -1.68543593  1.442389824
125 -1.431466432 -0.732206570  0.13316888 -1.270512425
126 -0.063895507 -1.019403862 -2.29230334  0.044572534
127  1.184059674  0.449736051  0.12349928 -0.200258192
128  0.328880357 -0.372646135 -1.38829366  0.898834906
129 -1.271480618  1.545636806 -0.87087514 -0.851305643
130 -0.400253998  0.168205508  0.11644102 -1.053899954
131 -0.400253998  0.168205508  0.11644102 -1.053899954
132  0.452779596  1.141685960  1.46789902  1.372035061
133 -0.059324839  2.006816546 -0.19181254 -0.726436030
134 -0.313516794  0.066224447  0.68853089  0.565949055
135  0.391138835 -0.332429990 -0.44681307  0.301832072
136 -0.352298393  0.792880845 -1.54876082  0.098718655
137 -0.296294095 -1.547340189  0.72537917 -1.426943802
138 -0.187766741  0.406926260  0.58033036  0.527835706
139 -0.970140442 -0.861299410  0.85866262  1.386178095
140 -0.362984111  0.601599950  0.18716182 -0.246787730
141 -0.660968594 -0.181078465 -0.86629913 -1.126493342
> # --  クラスタリング -----------
 警告メッセージ: 
1:  doTryCatch(return(expr), name, parentenv, handler) で: 
   ディスプレイリストが不完全に再描画されました 
2:  doTryCatch(return(expr), name, parentenv, handler) で: 
  invalid graphics state
3:  doTryCatch(return(expr), name, parentenv, handler) で: 
  invalid graphics state
> # --- 非階層的方法（k-means）
> set.seed(989898); (cl <- kmeans(fs$scores,7))
K-means clustering with 7 clusters of sizes 20, 24, 8, 17, 9, 33, 30

Cluster means:
         PA1        PA3         PA2        PA4
1 -0.8535679 -0.1769506 -0.40123938  1.0455806
2  0.8838008 -0.4046950 -0.36240628  0.4888756
3 -0.1691461 -1.9963573 -0.85934304 -0.5573957
4  0.8208990  0.2680643 -0.08956702 -0.8565472
5 -0.8075372 -1.2519658  1.17052382 -0.8884455
6  0.3526767  0.5472970  0.74745825  0.4274787
7 -0.7037490  0.5957449 -0.33603048 -0.6578315

Clustering vector:
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28 
  7   4   4   4   2   1   6   4   2   7   2   7   6   2   6   4   6   7   2   6   6   7   1   1   6   6   6   1 
 29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56 
  6   1   6   7   7   6   7   6   2   4   1   1   7   6   5   7   6   5   2   1   3   1   6   1   2   1   7   6 
 57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 
  4   7   6   1   2   7   2   4   4   6   6   4   6   2   6   2   2   1   7   4   7   5   6   2   6   6   5   2 
 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 
  7   3   6   7   4   3   1   2   1   4   2   4   2   5   4   7   5   5   3   3   3   7   6   7   2   2   7   7 
113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
  2   6   1   6   1   4   2   6   7   1   3   1   5   3   4   2   7   7   7   6   7   6   2   7   5   6   1   7 
141 
  7 

Within cluster sum of squares by cluster:
[1] 33.55807 31.44737 12.94973 14.74280 19.07678 33.24098 43.11845
 (between_SS / total_SS =  57.8 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss" "betweenss"    "size"        
[8] "iter"         "ifault"      
> set.seed(989898); (cl <- kmeans(fs$scores,6))
K-means clustering with 6 clusters of sizes 25, 37, 10, 35, 6, 28

Cluster means:
         PA1        PA3         PA2        PA4
1 -0.7695879 -0.1262055 -0.66444555  0.8318415
2  0.9755582 -0.1431164 -0.06030446  0.3639650
3 -1.2150146 -1.2181948  0.46973386 -1.0133994
4 -0.2464988  0.5558603 -0.26932912 -0.8620333
5  0.4529101 -2.2209577 -0.22104514 -0.6806849
6  0.0430067  0.5179652  0.88920912  0.3616616

Clustering vector:
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28 
  4   4   4   2   2   1   6   4   2   4   2   4   6   2   6   2   6   4   2   6   6   4   1   1   2   6   6   1 
 29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56 
  6   1   6   4   1   6   4   6   2   4   1   1   4   6   3   4   6   6   2   1   5   6   6   1   2   1   1   2 
 57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 
  2   4   2   1   2   4   2   4   2   6   2   4   6   2   6   2   2   1   4   4   1   3   2   2   2   2   5   2 
 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 
  3   5   6   4   4   5   1   2   1   2   2   4   2   3   4   4   3   3   5   3   3   4   6   6   2   2   4   4 
113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
  2   6   1   2   1   4   2   6   4   1   5   1   3   1   2   1   4   4   4   6   4   6   2   1   3   6   1   4 
141 
  4 

Within cluster sum of squares by cluster:
[1] 46.419807 50.257595 17.745250 56.850349  8.254129 30.608188
 (between_SS / total_SS =  52.8 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss" "betweenss"    "size"        
[8] "iter"         "ifault"      
> set.seed(989898); (cl <- kmeans(fs$scores,5))
K-means clustering with 5 clusters of sizes 33, 44, 8, 43, 13

Cluster means:
         PA1        PA3        PA2        PA4
1 -0.5547339 -0.1639712 -0.2285327  0.8516712
2  0.9465925  0.2031112  0.2230643  0.3235359
3 -0.1691461 -1.9963573 -0.8593430 -0.5573957
4 -0.3160864  0.5758038 -0.2681206 -0.7361962
5 -0.6460744 -0.9472731  1.2408215 -0.4788559

Clustering vector:
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28 
  4   4   4   2   2   1   2   4   2   4   2   4   4   1   2   2   2   4   1   1   1   4   1   1   2   4   2   1 
 29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56 
  4   1   1   4   4   2   4   2   2   4   1   1   4   2   5   4   2   5   2   1   3   1   1   1   2   1   4   2 
 57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 
  2   4   2   1   2   4   2   4   2   2   2   4   5   1   2   1   2   1   4   4   1   5   2   2   2   2   5   1 
 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 
  4   3   2   4   4   3   1   5   1   2   2   4   2   5   4   4   5   5   3   3   3   4   5   4   2   2   4   4 
113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
  2   2   1   2   1   4   2   5   4   1   3   1   5   3   2   1   4   4   4   2   4   1   2   4   5   1   1   4 
141 
  4 

Within cluster sum of squares by cluster:
[1] 51.99908 66.74803 12.94973 72.45709 31.08137
 (between_SS / total_SS =  47.2 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss" "betweenss"    "size"        
[8] "iter"         "ifault"      
> set.seed(989898); (cl <- kmeans(fs$scores,4))
K-means clustering with 4 clusters of sizes 29, 45, 14, 53

Cluster means:
         PA1         PA3         PA2        PA4
1 -0.7446150 -0.12227898 -0.80207871  0.5330181
2  0.9784478 -0.01783415 -0.08219729  0.1950799
3 -0.4976044 -1.81025926  0.17452898 -0.8355422
4 -0.2918841  0.56023126  0.46256142 -0.2365760

Clustering vector:
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28 
  1   4   4   2   2   1   4   2   2   4   2   1   4   2   4   2   2   4   2   4   4   4   1   1   2   4   4   1 
 29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56 
  4   1   4   4   1   4   1   4   2   2   1   1   4   4   3   4   2   4   2   1   3   4   4   1   2   1   1   2 
 57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 
  2   4   2   4   2   4   2   4   2   4   2   4   4   2   4   2   2   1   4   2   1   4   2   2   2   2   3   2 
 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 
  4   3   4   4   2   3   1   2   1   2   2   4   2   3   4   4   3   3   3   3   3   4   4   4   2   2   4   1 
113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
  2   2   1   2   1   2   2   4   4   1   3   1   3   1   2   1   4   4   4   4   4   4   2   1   3   4   1   4 
141 
  1 

Within cluster sum of squares by cluster:
[1] 61.91243 71.64646 34.68855 93.74669
 (between_SS / total_SS =  41.2 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss" "betweenss"    "size"        
[8] "iter"         "ifault"      
> set.seed(989898); (cl <- kmeans(fs$scores,3))
K-means clustering with 3 clusters of sizes 56, 69, 16

Cluster means:
         PA1        PA3        PA2        PA4
1 -0.6806197  0.3075092 -0.4075140  0.0256398
2  0.6764031  0.1304149  0.2444711  0.1603467
3 -0.5348193 -1.6386967  0.3720171 -0.7812343

Clustering vector:
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28 
  1   2   2   2   2   1   2   2   2   1   2   1   1   2   2   2   2   1   2   2   2   1   1   1   2   1   2   1 
 29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56 
  2   1   1   1   1   2   1   2   2   1   1   1   1   2   3   1   2   3   2   2   3   1   1   1   2   1   1   2 
 57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 
  2   1   2   1   2   1   2   2   2   2   2   2   2   2   2   2   2   1   1   2   1   3   2   2   2   2   3   2 
 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 
  1   3   2   1   2   3   1   2   1   2   2   2   2   3   2   1   3   3   3   3   3   1   2   1   2   2   1   1 
113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
  2   2   1   2   1   2   2   2   1   1   3   1   3   1   2   1   1   1   1   2   1   2   2   1   3   2   1   1 
141 
  1 

Within cluster sum of squares by cluster:
[1] 133.25341 127.40548  46.12196
 (between_SS / total_SS =  31.1 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss" "betweenss"    "size"        
[8] "iter"         "ifault"      
> set.seed(989898); (cl <- kmeans(fs$scores,2))
K-means clustering with 2 clusters of sizes 75, 66

Cluster means:
         PA1          PA3         PA2         PA4
1 -0.7107065 -0.006331679 -0.07146192 -0.06452367
2  0.8076210  0.007195089  0.08120673  0.07332235

Clustering vector:
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28 
  1   2   2   2   2   1   2   2   2   1   2   1   1   2   2   2   2   1   2   1   1   1   1   1   2   1   2   1 
 29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56 
  1   1   1   1   1   2   1   2   2   2   1   1   1   2   1   1   2   1   2   1   1   1   1   1   2   1   1   2 
 57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 
  2   1   2   1   2   1   2   2   2   2   2   2   1   2   2   2   2   1   1   2   1   1   2   2   2   2   2   2 
 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 
  1   2   2   1   2   2   1   2   1   2   2   2   2   1   2   1   1   1   2   1   1   1   1   1   2   2   1   1 
113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
  2   2   1   2   1   2   2   1   1   1   1   1   1   1   2   2   1   1   1   2   1   1   2   1   1   1   1   1 
141 
  1 

Within cluster sum of squares by cluster:
[1] 227.6004 135.4928
 (between_SS / total_SS =  18.5 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss" "betweenss"    "size"        
[8] "iter"         "ifault"      
